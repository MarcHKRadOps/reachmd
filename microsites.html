<html>
    <head>
        <script async src='https://www.googletagservices.com/tag/js/gpt.js'></script>
        <script>
            window.googletag = window.googletag || {cmd: []};
            var adSlot1, adSlot2, adSlot3, adSlot4, adSlot5, adSlot6, adSlot7, adSlot8, adSlot9;
            googletag.cmd.push(function() {
                var mapLeader = googletag.sizeMapping().
                    addSize([0, 0], [[300,250],[320,50],[1,1],'fluid']).
                    addSize([740, 0], [[728, 90],[1,1]]).
                    addSize([1025, 0], [[970, 250],[970,90],[728,90],[1,1],'fluid']).
                    build();
                var mapSticky = googletag.sizeMapping().
                    addSize([0, 0], [[320,50],[1,1]]).
                    addSize([1025, 0], [[970,90],[728,90],[1,1]]).
                    build();
                var microPref = 'err';
                var microSite = window.location.hostname.split(".").reverse()[1];   
                if(microSite == 'omniaeducation')
                {microPref = 'omn';}
                else if(microSite == 'provaeducation')
                {microPref = 'prv';}
                else if(microSite == 'medtelligence')
                {microPref = 'mtl';}
                else if(microSite == 'eyehealthacademy')
                {microPref = 'eha';}
                else if(microSite == 'globalneurologyacademy')
                {microPref = 'gna';}
                else if(microSite == 'globalwomenshealthacademy')
                {microPref = 'gwh';}
                else if(microSite == 'crohnscolitisprofessional')
                {microPref = 'ccp';}
                else if(microSite == 'rheumatologyacademy')
                {microPref = 'rha';}
                else if(microSite == 'globaloncologyacademy')
                {microPref = 'goa';}
                else
                {microPref = 'err';}
                adSlot1 = googletag.defineSlot('/21928603557/' + microPref + '/top', [728,90],'ad-top').defineSizeMapping(mapLeader).addService(googletag.pubads());
                adSlot2 = googletag.defineSlot('/21928603557/' + microPref + '/body1', [728,90],'ad-body1').defineSizeMapping(mapLeader).addService(googletag.pubads());
                adSlot3 = googletag.defineSlot('/21928603557/' + microPref + '/body2', [728,90],'ad-body2').defineSizeMapping(mapLeader).addService(googletag.pubads());
                adSlot4 = googletag.defineSlot('/21928603557/' + microPref + '/body3', [728,90],'ad-body3').defineSizeMapping(mapLeader).addService(googletag.pubads());
                adSlot5 = googletag.defineSlot('/21928603557/' + microPref + '/module1', [[300,250],[1,1],'fluid'],'ad-module1').addService(googletag.pubads());
                adSlot6 = googletag.defineSlot('/21928603557/' + microPref + '/module2', [[300,250],[1,1],'fluid'],'ad-module2').addService(googletag.pubads());
                adSlot7 = googletag.defineSlot('/21928603557/' + microPref + '/module3', [[300,250],[1,1],'fluid'],'ad-module3').addService(googletag.pubads());
                adSlot8 = googletag.defineSlot('/21928603557/' + microPref + '/module4', [[300,250],[1,1],'fluid'],'ad-module4').addService(googletag.pubads());
                adSlot9 = googletag.defineSlot('/21928603557/' + microPref + '/footer', [728,90],'ad-footer').defineSizeMapping(mapSticky).addService(googletag.pubads());
                googletag.pubads().setTargeting("site", microSite);
                var pathParts = window.location.pathname.substr(0).split("/");
                googletag.pubads().setTargeting("agg1", pathParts[1] ? pathParts[1] : "home");
                googletag.pubads().setTargeting("agg2", pathParts[2] ? pathParts[2] : "none");
                googletag.pubads().setTargeting("details-program", pathParts[3] ? pathParts[3].slice(0,40) : "none");
                googletag.pubads().setTargeting("tag", pathParts[4] ? pathParts[4] : "none");
                googletag.pubads().setTargeting("p", );
                googletag.pubads().setTargeting("s", );
                googletag.pubads().setTargeting("i", );
                googletag.pubads().disableInitialLoad();
                //googletag.pubads().enableSingleRequest();
                //googletag.pubads().collapseEmptyDivs(true);
                googletag.enableServices();
            });
            function afterAdsRenderEnded() {
                const adBanner = $('.js-ad-banner');
                const adText = adBanner.parent().find('.ad-text-info');
                console.log("AICI");
                console.log(adBanner.height());
                if (adBanner.height() > 0) {
                    adText.css('display', 'block');
                }
            }
            var refreshSlots = function() {
                googletag.cmd.push(function() {
                    // refresh ads
                    googletag.pubads().refresh([adSlot1, adSlot2, adSlot3, adSlot4, adSlot5, adSlot6, adSlot7, adSlot8, adSlot9]);
                    let eventListnerCreated = false;
                    if (!eventListnerCreated) {
                        eventListnerCreated = true;
                        googletag.pubads().addEventListener('slotRenderEnded', afterAdsRenderEnded);
                    }
                });
            };
        </script>
    </head>

    <body>

        <h2 style='padding: 20px 0px;'>test</h2>
        <h5>ads</h5>
        <div>
            <span>Advertisement</span>
        </div>
        <div id='ad-top'>
            <script type='text/javascript'>
                googletag.cmd.push(function() {
                    googletag.display('ad-top');
                });
            </script>
        </div>
        <div>
            <span>Advertisement</span>
        </div>
        <div id='ad-body1'>
            <script type='text/javascript'>
                googletag.cmd.push(function() {
                    googletag.display('ad-body1');
                });
            </script>
        </div>
        <div>
            <span>Advertisement</span>
        </div>
        <div id='ad-body2'>
            <script type='text/javascript'>
                googletag.cmd.push(function() {
                    googletag.display('ad-body2');
                });
            </script>
        </div>
        <div>
            <span>Advertisement</span>
        </div>
        <div id='ad-body3'>
            <script type='text/javascript'>
                googletag.cmd.push(function() {
                    googletag.display('ad-body3');
                });
            </script>
        </div>

        <div>
            <span>Advertisement</span>
        </div>
        <div id='ad-module1'>
            <script type='text/javascript'>
                googletag.cmd.push(function() {
                    googletag.display('ad-module1');
                });
            </script>
        </div>
        <div>
            <span>Advertisement</span>
        </div>
        <div id='ad-module2'>
            <script type='text/javascript'>
                googletag.cmd.push(function() {
                    googletag.display('ad-module2');
                });
            </script>
        </div>        
        <div>
            <span>Advertisement</span>
        </div>
        <div id='ad-module3'>
            <script type='text/javascript'>
                googletag.cmd.push(function() {
                    googletag.display('ad-module3');
                });
            </script>
        </div>        
        <div>
            <span>Advertisement</span>
        </div>
        <div id='ad-module4'>
            <script type='text/javascript'>
                googletag.cmd.push(function() {
                    googletag.display('ad-module4');
                });
            </script>
        </div>

        <div class="sticky-ad-container" style="position:-webkit-sticky; position:sticky; bottom: 0; background-color: lightblue; margin-top: 20px;z-index:22 !important;">
        <div>
            <span>Advertisement</span>
        </div>
            <div id='ad-footer' style="margin: 0 auto;background-color: lightgrey">
                <script type='text/javascript'>
                    googletag.cmd.push(function() {
                        googletag.display('ad-footer');
                    });
                </script>
            </div>
        </div>
    </body>
</html>